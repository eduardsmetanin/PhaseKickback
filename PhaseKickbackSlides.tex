\documentclass[12pt,twoside,a4paper]{article}
\author{Eduard Smetanin}
\title{\vspace{-2.0cm}Phase Kickback}
\usepackage{a4wide}
\usepackage{amsmath}
\usepackage{qcircuit}
\usepackage{braket}
\usepackage{chemarrow}
\usepackage{setspace}
\onehalfspacing
\usepackage{hyperref}
\begin{document}
\maketitle

\begin{equation*}
        \Qcircuit @C=1em @R=1em {
                \lstick{\ket{+}}
                & \qw & \ctrl{1} & \qw & \meter \\
                \lstick{\ket{\psi}} & \qw & \gate{U} & \qw & \qw \\
                & \uparrow & & \uparrow \\
                & A & & B
        }
\end{equation*}

$U$ - arbitrary

$\ket{+} \equiv \ket{+x} \equiv H \ket{0} = \frac{1}{\sqrt{2}} (\ket{0} + \ket{1})$

$A$: $\frac{\ket{0} + \ket{1}}{\sqrt{2}} \ket{\psi}
= \frac{\ket{0} \ket{\psi} + \ket{1} \ket{\psi}}{\sqrt{2}}$

$B$: $\frac{\ket{0} \ket{\psi} + \ket{1} U \ket{\psi}}{\sqrt{2}}$

$\ket{\psi}$ - an eigenvector of $U$ with eigenvalue $e^{i\phi}$

$U \ket{\psi} = e^{i\phi} \ket{\psi}$

$B$: $\frac{\ket{0} \ket{\psi} + \ket{1} e^{i\phi} \ket{\psi}}{\sqrt{2}}
= \frac{\ket{0} + e^{i\phi} \ket{1}}{\sqrt{2}}  \ket{\psi}$.

Requirements for phase kickback to occur:
\begin{itemize}
        \item \emph{The control qubit(s) must be in a superposition.} \\
        This is because otherwise applying controlled operation will just change global phase:
\begin{equation*}
        \ket{1} \ket{\psi} \autorightarrow{\Qcircuit @C=.25em @R=.3em {& \ctrl{1} & \qw \\ & \gate{U} & \qw}}{} \ket{1} U \ket{\psi} = \ket{1} e^{i\phi} \ket{\psi} \cong \ket{1} \ket{\psi}
\end{equation*}
        \item \emph{$\ket{\psi}$ must be an eigenvector of operator $U$.}
        \item \emph{Arbitrary operator $U$ must be applied in a controlled way.} \\
        If we apply $U$ unconditionally, we would just change global phase of a state:
        \begin{equation*}
                U \frac{\ket{0} + \ket{1}}{\sqrt{2}} \ket{\psi}
                = e^{i\phi} \frac{\ket{0} + \ket{1}}{\sqrt{2}} \ket{\psi}
                \cong \frac{\ket{0} + \ket{1}}{\sqrt{2}} \ket{\psi}
        \end{equation*}
\end{itemize}

\begin{center}
        \begin{tabular}[t]{|c|c|}
                \hline
                \multicolumn{2}{|c|}{$f_{00}$} \\
                \hline
                input & output \\
                \hline
                00 & 1 \\
                01 & 0 \\
                10 & 0 \\
                11 & 0 \\
                \hline
        \end{tabular}
        \begin{tabular}[t]{|c|c|}
                \hline
                \multicolumn{2}{|c|}{$f_{01}$} \\
                \hline
                input & output \\
                \hline
                00 & 0 \\
                01 & 1 \\
                10 & 0 \\
                11 & 0 \\
                \hline
        \end{tabular}
        \begin{tabular}[t]{|c|c|}
                \hline
                \multicolumn{2}{|c|}{$f_{10}$} \\
                \hline
                input & output \\
                \hline
                00 & 0 \\
                01 & 0 \\
                10 & 1 \\
                11 & 0 \\
                \hline
        \end{tabular}
        \begin{tabular}[t]{|c|c|}
                \hline
                \multicolumn{2}{|c|}{$f_{11}$} \\
                \hline
                input & output \\
                \hline
                00 & 0 \\
                01 & 0 \\
                10 & 0 \\
                11 & 1 \\
                \hline
        \end{tabular}
\end{center}

\begin{equation*}
        \Qcircuit @C=1em @R=1em {
                \lstick{\ket{+}} & \qw & \multigate{2}{U_f} & \qw & \multigate{1}{M} & \qw & \meter \\
                \lstick{\ket{+}} & \qw & \ghost{U_f} & \qw & \ghost{U_f} & \qw & \meter \\
                \lstick{\ket{-}} & \qw & \ghost{U_f} & \qw & \qw & \qw & \qw & trash \\
                & \uparrow & & \uparrow \\
                & A & & B
        }
\end{equation*}

$\ket{+} \equiv \ket{+x} \equiv H \ket{0} = \frac{1}{\sqrt{2}} (\ket{0} + \ket{1})$

$\ket{-} \equiv \ket{-x} \equiv H \ket{1} = \frac{1}{\sqrt{2}} (\ket{0} - \ket{1})$

\begin{equation*}
        \Qcircuit @C=1em @R=1em {
                \lstick{\ket{a}} & \qw & \multigate{2}{U_f} & \qw & \qw & \ket{a} \\
                \lstick{\ket{b}} & \qw & \ghost{U_f} & \qw & \qw & \ket{b} \\
                \lstick{\ket{c}} & \qw & \ghost{U_f} & \qw & \qw & & & \ket{c \oplus f(a, b)}
        }
\end{equation*}

$A$:

$\ket{+} \ket{+} \ket{-}$

$= \frac{1}{2} (\ket{00} + \ket{01} + \ket{10} + \ket{11}) \ket{-}$

$= \frac{1}{2} (\ket{00} \ket{-} + \ket{01} \ket{-} + \ket{10} \ket{-} + \ket{11} \ket{-})$

$f = f_{00}$

$B$:

\begin{equation*}
        \begin{split}
                \frac{1}{2} (\ket{00} U_{f_{00}} \ket{-} + \ket{01} \ket{-} + \ket{10} \ket{-} + \ket{11} \ket{-}) \\
                = \frac{1}{2} (\ket{00} (-1) \ket{-} + \ket{01} \ket{-} + \ket{10} \ket{-} + \ket{11} \ket{-}) \\
                = \frac{1}{2} (- \ket{00} + \ket{01} + \ket{10} + \ket{11}) \ket{-}
        \end{split}
\end{equation*}

$f = f_{01}$

$B$:

\begin{equation*}
        \begin{split}
                \frac{1}{2} (\ket{00} \ket{-} + \ket{01} U_{f_{01}} \ket{-} + \ket{10} \ket{-} + \ket{11} \ket{-}) \\
                = \frac{1}{2} (\ket{00} \ket{-} + \ket{01} (-1) \ket{-} + \ket{10} \ket{-} + \ket{11} \ket{-}) \\
                = \frac{1}{2} (\ket{00} - \ket{01} + \ket{10} + \ket{11}) \ket{-}
        \end{split}
\end{equation*}

Phase kickback is used in many quantum algorithms, for instance:
\begin{itemize}
        \item Deutsch
        \item Simon
        \item Shor
        \item Grover
        \item Phase estimation
\end{itemize}

\end{document}
